<form [formGroup]="userForm" #formDir="ngForm">
  <div [hidden]="formDir.submitted">

  <div
    class="cross-validation"
    [class.cross-validation-error]="userForm.errors?.['identityRevealed'] && (userForm.touched || userForm.dirty)"
  >
    <div class="form-group">
      <label for="name">Name:</label>
      <input
        type="text"
        id="name"
        name="name"
        formControlName="name"
        required
      />
      <div
        *ngIf="name.invalid && (name.dirty || name.touched)"
        class="alert alert-danger"
      >
        <div *ngIf="name.errors?.['required']">Name is required.</div>
      </div>
    </div>

    <div class="form-group">
      <label for="gender">Gender</label>
      <select
        id="gender"
        class="form-control"
        formControlName="gender"
        required
      >
        <option *ngFor="let g of genderOptions" [value]="g">{{ g }}</option>
      </select>

      <div *ngIf="gender.invalid && gender.touched" class="alert alert-danger">
        <div *ngIf="gender.errors?.['required']">Gender is required.</div>
      </div>
    </div>
  </div>

  <div class="form-group">
    <label for="date">Date of birth:</label>
    <input
      type="date"
      id="date"
      name="date"
      [max]="maxDate"
      (change)="onDateChange($event)"
      formControlName="date"
      required
    />

    <div *ngIf="date.invalid && date.touched" class="alert alert-danger">
      <div *ngIf="date.errors?.['required']">Date is required.</div>
    </div>
  </div>

  <div class="form-group">
    <label for="age">Age:</label>
    <input type="number" id="age" name="age" formControlName="age" readonly />
  </div>

  <div class="form-group">
    <label for="contact">Contact details:</label>
    <input
      type="text"
      id="contact"
      name="contact"
      formControlName="contact"
      required
      pattern="06[0-9]{8}"
    />
    <div
      *ngIf="contact!.invalid && (contact!.dirty || contact!.touched)"
      class="alert alert-danger"
    >
      <div *ngIf="contact!.errors?.['required']">Contact is required.</div>
      <div *ngIf="contact!.hasError('pattern')">
        Contact must start with '06' followed by 8 digits.
      </div>
    </div>
  </div>

  <div class="form-group">
    <label for="email">Email:</label>
    <input
      type="email"
      id="email"
      name="email"
      formControlName="email"
      required
    />
    <div
      *ngIf="email!.invalid && (email!.dirty || email!.touched)"
      class="alert alert-danger"
    >
      <div *ngIf="email!.errors?.['required']">Email is required.</div>
      <div *ngIf="email!.hasError('pattern')">Email must be a valid email address</div>
    </div>
  </div>

  <div class="form-group">
    <label for="password">Password:</label>
    <input
      type="password"
      id="password"
      name="password"
      formControlName="password"
      required
    />
    <div
      *ngIf="password!.invalid && (password!.dirty || password!.touched)"
      class="alert alert-danger"
    >
      <div *ngIf="password!.errors?.['required']">Password is required.</div>
      <div *ngIf="password!.errors?.['pattern']">
        min length 8, at least one uppercase, at least one number
      </div>
    </div>
  </div>

  <div class="form-group">
    <label for="passwordRepeat">Repeat password:</label>
    <input
      type="password"
      id="passwordRepeat"
      name="passwordRepeat"
      formControlName="passwordRepeat"
      required
    />
    <div
      *ngIf="
        passwordRepeat!.invalid &&
        (passwordRepeat!.dirty || passwordRepeat!.touched)
      "
      class="alert alert-danger"
    >
      <div *ngIf="passwordRepeat!.errors?.['required']">
        Repeat password is required.
      </div>
      <!-- <div *ngIf="password!.errors?.['pattern']">min length 8, at least one uppercase, at least one number</div> -->
    </div>
  </div>

  <button type="submit" class="btn btn-default" [disabled]="userForm.invalid">
    Submit
  </button>
  <button type="button" class="btn btn-default" (click)="formDir.resetForm({})">
    Reset
  </button>
</div>

  <div class="submitted-message" *ngIf="formDir.submitted">
    <p>You've submitted your hero, {{ userForm.value.name }}!</p>
    <button type="button" (click)="formDir.resetForm({})">Add new user</button>
  </div>

</form>
